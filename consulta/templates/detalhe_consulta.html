{% extends 'menu.html' %}

{% block title %}Detalhes da Consulta{% endblock %}

{% block content %}
{% load static %}
<!-- Carregando o CSS -->
<link rel="stylesheet" href="{% static 'css/accordion_avaliacao.css' %}" />
<!-- Carregando o JS de ScrollSpy -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- Carregando o JS personalizado -->
<script defer src="{% static 'js/scrollspy_consulta.js' %}"></script>
<script defer src="{% static 'js/fullscreen.js' %}"></script>


<div class="container-fluid content-offset" data-bs-spy="scroll" data-bs-target=".sidebar" data-bs-offset="100"
    tabindex="0">
    <div class="row">
        <!-- Sidebar -->
        <aside class="col-md-3 mb-4">
            <div class="sidebar shadow-sm position-sticky sticky-top">
                <ul class="nav flex-column">
                    <li class="nav-item"><a href="#info" class="nav-link">ğŸ“„ InformaÃ§Ãµes</a></li>
                    <li class="nav-item"><a href="#problemas" class="nav-link">ğŸ§  Problemas de SaÃºde</a></li>
                    <li class="nav-item"><a href="#medicamentos" class="nav-link">ğŸ’Š Medicamentos</a></li>
                    <li class="nav-item"><a href="#avaliacao" class="nav-link">ğŸ“ AvaliaÃ§Ã£o</a></li>
                    <li class="nav-item"><a href="#plano" class="nav-link">ğŸ“Œ Plano de AtuaÃ§Ã£o</a></li>
                </ul>
            </div>
        </aside>

        <!-- Main content -->
        <main class="col-md-9">
            <h2 class="mb-4 text-primary">ğŸ©º Detalhes da Consulta</h2>
            <div class="text-end mb-3">
                <a href="{% url 'visualizar_consulta' consulta.id %}" class="btn btn-outline-primary">
                    ğŸ“„ Visualizar prontuÃ¡rio completo
                </a>
                </div>

            <!-- InformaÃ§Ãµes -->
            <section id="info" class="card section-card section shadow-sm mb-4">
                <div class="card-body">
                    <h5 class="section-title">ğŸ‘¤ Paciente: {{ consulta.paciente.nome }}</h5>
                    <p><strong>ğŸ“… Data da Consulta:</strong> {{ consulta.data_consulta }}</p>
                    <p><strong>â“ Motivo:</strong> {{ consulta.motivo_consulta }}</p>
                    <p><strong>ğŸ“ˆ EvoluÃ§Ã£o:</strong> {{ consulta.evolucao }}</p>
                    <p><strong>ğŸ“‹ PrescriÃ§Ãµes e Exames:</strong> {{ consulta.prescricoes_exames }}</p>
                    <p><strong>ğŸ”œ PrÃ³xima revisÃ£o:</strong> {{ consulta.data_proxima_revisao }}</p>

                    {% if consulta.exames_arquivo %}
                        <p><strong>ğŸ“ Arquivo(s) Anexado(s):</strong>
                            <a href="{{ consulta.exames_arquivo.url }}" target="_blank" class="btn btn-sm btn-outline-primary ms-2">
                                ğŸ“¥ Baixar/Visualizar Arquivo
                            </a>
                        </p>
                    {% endif %}
                </div>
            </section>


            <!-- Problemas de SaÃºde -->
            <section id="problemas" class="card section-card section shadow-sm mb-4">
                <div class="card-body">
                    <h5 class="section-title">ğŸ§  Problemas de SaÃºde</h5>
                    {% include 'partials/accordion_problema_saude.html' %}
                </div>
            </section>

            <!-- Medicamentos -->
            <section id="medicamentos" class="card section-card section shadow-sm mb-4">
                <div class="card-body">
                    <h5 class="section-title">ğŸ’Š Medicamentos</h5>
                    {% include 'partials/accordion_medicamento.html' %}
                </div>
            </section>

            <!-- AvaliaÃ§Ã£o -->
            <section id="avaliacao" class="card section-card section shadow-sm mb-4">
                <div class="card-body">
                    <h5 class="section-title">ğŸ“ AvaliaÃ§Ã£o</h5>

                    <div class="tabela-avaliacao-wrapper">
                        <button id="open-fullscreen" class="btn btn-sm btn-outline-primary mb-3">ğŸ” Tela cheia</button>
                        {% include 'partials/accordion_avaliacao.html' %}
                    </div>
            </section>

            <!-- Plano de AtuaÃ§Ã£o -->
            <section id="plano" class="card section-card section shadow-sm mb-4">
                <div class="card-body">
                    <h5 class="section-title">ğŸ“Œ Plano de AtuaÃ§Ã£o</h5>
                    {% include 'partials/accordion_plano_atuacao.html' %}
                </div>
                  
            </section>

              
        </main>
    </div>
    <!-- Modal Fullscreen -->
    <div id="avaliacao-fullscreen" class="fullscreen-overlay d-none">
        <div class="fullscreen-content">
            <button id="close-fullscreen" class="btn btn-danger btn-sm mb-3">âŒ Fechar</button>
            {% include 'partials/accordion_avaliacao.html' %}
        </div>
    </div>
</div>
{% endblock %}